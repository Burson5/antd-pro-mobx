(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{Yzqn:function(module,exports,__webpack_require__){"use strict";(function(module){Object.defineProperty(exports,"__esModule",{value:!0});var _card=__webpack_require__("O4zX"),_card2=_interopRequireDefault(_card),_row=__webpack_require__("CS/S"),_row2=_interopRequireDefault(_row),_col=__webpack_require__("PikB"),_col2=_interopRequireDefault(_col),_form=__webpack_require__("1qDr"),_form2=_interopRequireDefault(_form),_button=__webpack_require__("t04f"),_button2=_interopRequireDefault(_button),_input=__webpack_require__("lcDK"),_input2=_interopRequireDefault(_input),_message2=__webpack_require__("QaIW"),_message3=_interopRequireDefault(_message2),_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}(),_react=__webpack_require__("rdAL"),_react2=_interopRequireDefault(_react),_ajax=__webpack_require__("ywuN"),_ajax2=_interopRequireDefault(_ajax),_api=__webpack_require__("mhnJ"),_login=__webpack_require__("SlXe"),_login2=_interopRequireDefault(_login),enterModule;function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){return function r(o,n){try{var u=t[o](n),l=u.value}catch(e){return void a(e)}if(!u.done)return Promise.resolve(l).then(function(e){r("next",e)},function(e){r("throw",e)});e(l)}("next")})}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}enterModule=__webpack_require__("2xmg").enterModule,enterModule&&enterModule(module);var formItemLayout={labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:10}}},RePassword=function(_Component){function RePassword(e){var t=this;_classCallCheck(this,RePassword);var a=_possibleConstructorReturn(this,(RePassword.__proto__||Object.getPrototypeOf(RePassword)).call(this,e));return a.initial=function(){console.log("initial with here!")},a.handleSubmit=function(e){var r;e.preventDefault(),a.props.form.validateFieldsAndScroll((r=_asyncToGenerator(regeneratorRuntime.mark(function e(r,o){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=11;break}if(console.log("Received values of form: ",o),a.state.configPhoneNumber){e.next=10;break}return e.next=5,(0,_api.putPassword)({phone:o.currentPhoneNumber,oldPassWord:o.oldPassword,newPassWord:o.newPassWord});case 5:n=e.sent,console.log(n),0===n.code?_message3.default.success("密码修改成功！"):_message3.default.success("修改失败 请您稍后再次尝试！"),e.next=11;break;case 10:(0,_ajax2.default)({url:"/api/v1/user/phone",method:"PUT",data:{phone:o.newPhoneNumber,password:o.password,captcha:o.captcha}}).then(function(e){console.log(e),0===e.code?_message3.default.success("手机号修改成功！"):_message3.default.success("修改失败 请您稍后再次尝试！")}).catch(function(e){console.log(e),_message3.default.error("出了些问题，手机号未能修改成功，如有需要请联系客服！")});case 11:case"end":return e.stop()}},e,t)})),function(e,t){return r.apply(this,arguments)}))},a.validateToNextPassword=function(e,t,r){var o=a.props.form.form;t&&a.state.confirmDirty&&o.validateFields(["compareNewPassWord"],{force:!0}),r()},a.compareToFirstPassword=function(e,t,r){var o=a.props.form.form;t&&t!==o.getFieldValue("newPassWord")?r("两次密码不一致！"):r()},a.state={CaptchaButtonValue:"获取验证码",disabled:!1,configPhoneNumber:!1},a.initial(),a}return _inherits(RePassword,_Component),_createClass(RePassword,[{key:"render",value:function(){var e=this,t=_login2.default.getUserInfo()||{},a=this.props.form.getFieldDecorator;return _react2.default.createElement("div",null,_react2.default.createElement(_card2.default,{bordered:!1},_react2.default.createElement(_form2.default,{onSubmit:this.handleSubmit},_react2.default.createElement(_form2.default.Item,_extends({},formItemLayout,{label:"当前手机号"}),a("currentPhoneNumber",{initialValue:t.name})(_react2.default.createElement(_input2.default,{disabled:!0})),_react2.default.createElement(_button2.default,{style:{marginTop:20},onClick:function(){e.setState({configPhoneNumber:!e.state.configPhoneNumber})}},this.state.configPhoneNumber?"取消":"修改手机号")),this.state.configPhoneNumber?[_react2.default.createElement(_form2.default.Item,_extends({},formItemLayout,{label:"登录密码",key:"password"}),a("password",{rules:[{required:!0,message:"请输入登录密码"}]})(_react2.default.createElement(_input2.default,{type:"password",placeholder:"输入登录密码"}))),_react2.default.createElement(_form2.default.Item,_extends({},formItemLayout,{label:"新手机号",key:"newPhoneNumber"}),a("newPhoneNumber",{rules:[{required:!0,pattern:/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/,message:"请核对您的新手机号！"}]})(_react2.default.createElement(_input2.default,{placeholder:"输入手机号"}))),_react2.default.createElement(_form2.default.Item,_extends({},formItemLayout,{label:"验证码",key:"captcha"}),a("captcha",{rules:[{required:!0,message:"请输入验证码！"}]})(_react2.default.createElement(_row2.default,null,_react2.default.createElement(_col2.default,{span:14},_react2.default.createElement(_input2.default,null)),_react2.default.createElement(_col2.default,{push:2,span:8},_react2.default.createElement(_button2.default,{disabled:this.state.disabled,onClick:function(){var t=e.props.form.getFieldValue("newPhoneNumber");if(void 0!==t){if("获取验证码"===e.state.CaptchaButtonValue){e.setState({CaptchaButtonValue:59,disabled:!0});var a=setInterval(function(){e.state.CaptchaButtonValue>1?e.setState({CaptchaButtonValue:e.state.CaptchaButtonValue-1}):(e.setState({CaptchaButtonValue:"获取验证码",disabled:!1}),clearInterval(a))},1e3)}(0,_ajax2.default)({method:"PUT",url:"/api/v1/captcha",data:{phone:t,type:3}}).then(function(e){console.log(e),0===e.code?_message3.default.success("验证码已发送，请注意查收！"):_message3.default.error("出了些问题，验证码未能发送成功，如有需要请联系客服！")}).catch(function(e){console.log(e),_message3.default.error("出了些问题，验证码未能发送成功，如有需要请联系客服！")})}else _message3.default.info("请确认您的手机号！")}},"获取验证码"===this.state.CaptchaButtonValue?this.state.CaptchaButtonValue:this.state.CaptchaButtonValue+"s")))))]:[_react2.default.createElement(_form2.default.Item,_extends({},formItemLayout,{label:"原密码",key:"oldPassWord"}),a("oldPassWord",{rules:[{required:!0,message:"请输入您的原密码！"}]})(_react2.default.createElement(_input2.default,{type:"password",placeholder:"输入原密码"}))),_react2.default.createElement(_form2.default.Item,_extends({},formItemLayout,{label:"新密码",key:"newPassWord"}),a("newPassWord",{rules:[{required:!0,pattern:/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{7,18}$/,message:"请输入数字+字母，8-18位的新密码！"}]})(_react2.default.createElement(_input2.default,{type:"password",placeholder:"输入新密码，数字+字母，8-18位"}))),_react2.default.createElement(_form2.default.Item,_extends({},formItemLayout,{label:"确认密码",key:"compareNewPassWord"}),a("compareNewPassWord",{rules:[{required:!0,message:"请确认您的新密码"},{validator:this.compareToFirstPassword}]})(_react2.default.createElement(_input2.default,{type:"password",placeholder:"确认新密码"})))],_react2.default.createElement(_form2.default.Item,_extends({},formItemLayout,{wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:5}}}),_react2.default.createElement(_button2.default,{type:"primary",style:{width:280},htmlType:"submit"},"提交修改")))))}},{key:"__reactstandin__regenerateByEval",value:function __reactstandin__regenerateByEval(key,code){this[key]=eval(code)}}]),RePassword}(_react.Component),_default=_form2.default.create()(RePassword),reactHotLoader,leaveModule;exports.default=_default,reactHotLoader=__webpack_require__("2xmg").default,leaveModule=__webpack_require__("2xmg").leaveModule,reactHotLoader&&(reactHotLoader.register(formItemLayout,"formItemLayout","/Users/gongzhen/workspace/_gongzhen/antd-pro-mobx/src/page/Account/index.js"),reactHotLoader.register(RePassword,"RePassword","/Users/gongzhen/workspace/_gongzhen/antd-pro-mobx/src/page/Account/index.js"),reactHotLoader.register(_default,"default","/Users/gongzhen/workspace/_gongzhen/antd-pro-mobx/src/page/Account/index.js"),leaveModule(module))}).call(this,__webpack_require__("bU9k")(module))}}]);